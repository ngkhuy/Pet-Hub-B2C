services:
  # Frontend Service
  - type: web
    name: frontend
    env: node
    plan: free
    root: front-end
    buildCommand: npm install && npm run build
    startCommand: npx next start -H 0.0.0.0
    envVars:
      - key: NODE_ENV
        value: production
      - key: NEXT_PUBLIC_URL
        value: https://pethub-frontend.onrender.com # Update with your actual Render URL after deploy
      - key: NEXT_PUBLIC_BRAND_NAME
        value: PetHub
      - key: NEXT_PUBLIC_DESCRIPTION
        value: PetCare helps you book vet appointments, pet spa, hotel, and adoption services with ease.
      - key: NEXT_PUBLIC_FACEBOOK_URL
        value: https://www.facebook.com/petcare
      - key: NEXT_PUBLIC_INSTAGRAM_URL
        value: https://www.instagram.com/petcare
      - key: NEXT_PUBLIC_GITHUB_URL
        value: https://github.com/petcare
      - key: NEXT_PUBLIC_SUPPORT_EMAIL
        value: support@petcare.vn
      - key: NEXT_PUBLIC_PHONE_NUMBER
        value: +84123456789
      # API URLs matching services below
      - key: NEXT_PUBLIC_AUTH_API
        fromService:
          type: web
          name: auth-service
          property: url
          envVarKey: NEXT_PUBLIC_AUTH_API_URL # Temporary helper, usually constructed manually in code or full URL
      - key: NEXT_PUBLIC_USER_MANAGEMENT_API
        fromService:
          type: web
          name: user-management-service
          property: url
      - key: NEXT_PUBLIC_BOOKING_API
        fromService:
          type: web
          name: booking-service
          property: url
      - key: NEXT_PUBLIC_VET_API
        fromService:
          type: web
          name: vet-service
          property: url

  # Auth Service
  - type: web
    name: auth-service
    env: python
    plan: free
    root: auth-service
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: JWT_SECRET_KEY
        value: secretkey_jwt123
      - key: JWT_ALGORITHM
        value: HS256
      - key: ACCESS_TOKEN_EXPIRE_MINUTES
        value: 30
      - key: REFRESH_TOKEN_EXPIRE_DAYS
        value: 7
      - key: APP_ENV
        value: production
      - key: DATABASE_URL
        value: postgresql+asyncpg://postgres.yccuyuaqigkxosbpdcul:GyNiA90mn1TBObig@aws-1-ap-southeast-2.pooler.supabase.com:6543/postgres
      - key: USER_SERVICE_INTERNAL_BASE_URL
        fromService:
          type: web
          name: user-management-service
          property: url

  # User Management Service
  - type: web
    name: user-management-service
    env: python
    plan: free
    root: user-management-service
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: JWT_SECRET_KEY
        value: secretkey_jwt123
      - key: JWT_ALGORITHM
        value: HS256
      - key: MAIL_USERNAME
        value: ngkhuy.159@gmail.com
      - key: MAIL_PASSWORD
        value: ykly uuhs urir etzl
      - key: MAIL_FROM
        value: ngkhuy.159@gmail.com
      - key: MAIL_PORT
        value: 587
      - key: MAIL_SERVER
        value: smtp.gmail.com
      - key: MAIL_STARTTLS
        value: True
      - key: MAIL_SSL_TLS
        value: False
      - key: DATABASE_URL
        value: postgresql+asyncpg://postgres.anwgeinbyeadpgnhszpr:WFQrRR17F5P49yoa@aws-1-ap-southeast-2.pooler.supabase.com:6543/postgres
      - key: AUTH_SERVICE_INTERNAL_BASE_URL
        fromService:
          type: web
          name: auth-service
          property: url

  # Booking Service
  - type: web
    name: booking-service
    env: python
    plan: free
    root: booking-service
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: JWT_SECRET_KEY
        value: secretkey_jwt123
      - key: JWT_ALGORITHM
        value: HS256
      - key: DATABASE_URL
        value: postgresql+asyncpg://postgres.jxiugzjubbucxudvvbvo:SHVCxbOXIsmzLyLS@aws-1-ap-southeast-1.pooler.supabase.com:6543/postgres

  # Vet Service
  - type: web
    name: vet-service
    env: python
    plan: free
    root: vet-service
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: JWT_SECRET_KEY
        value: secretkey_jwt123
      - key: JWT_ALGORITHM
        value: HS256
      - key: DATABASE_URL
        value: postgresql+asyncpg://postgres.gwyspssvgudotjvdojpl:w18imz72gitJSK6W@aws-1-ap-south-1.pooler.supabase.com:6543/postgres
