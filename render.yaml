services:
  # Frontend (Docker Web Service)
  - type: web
    name: petcare-frontend
    env: docker  # Chuyển sang Docker runtime
    repo: https://github.com/ngkhuy/Pet-Hub-B2C  # Repo GitHub của bạn
    rootDir: ./front-end
    dockerfilePath: ./Dockerfile  # Giữ nguyên, Render sẽ build từ đây
    dockerContext: ./  # Context cho build (thư mục front-end)
    plan: free
    region: singapore  # Cùng region cho private network
    envVars:
      - key: JWT_SECRET_KEY
        value: secretkey_jwt123
      - key: JWT_ALGORITHM
        value: HS256
      - key: NEXT_PUBLIC_URL
        value: https://petcare-frontend.onrender.com  # Update sau deploy nếu domain khác
      - key: NEXT_PUBLIC_BRAND_NAME
        value: PetHub
      - key: NEXT_PUBLIC_DESCRIPTION
        value: PetCare helps you book vet appointments, pet spa, hotel, and adoption services with ease.
      - key: NEXT_PUBLIC_AUTH_API
        value: https://petcare-auth.onrender.com/api/auth  # Internal/public URL
      - key: NEXT_PUBLIC_USER_MANAGEMENT_API
        value: https://petcare-user-management.onrender.com/api/ums
      - key: NEXT_PUBLIC_BOOKING_API
        value: https://petcare-booking.onrender.com/api/booking
      - key: NEXT_PUBLIC_VET_API
        value: https://petcare-vet.onrender.com/api/vet
      - key: NEXT_PUBLIC_FACEBOOK_URL
        value: https://www.facebook.com/petcare
      - key: NEXT_PUBLIC_INSTAGRAM_URL
        value: https://www.instagram.com/petcare
      - key: NEXT_PUBLIC_GITHUB_URL
        value: https://github.com/petcare
      - key: NEXT_PUBLIC_SUPPORT_EMAIL
        value: support@petcare.vn
      - key: NEXT_PUBLIC_PHONE_NUMBER
        value: +84123456789
      - key: NODE_ENV
        value: production
    # Không cần buildCommand/startCommand nữa, dùng CMD từ Dockerfile

  # Auth Service (Docker Web Service)
  - type: web
    name: petcare-auth
    env: docker
    repo: https://github.com/ngkhuy/Pet-Hub-B2C
    rootDir: ./auth-service
    dockerfilePath: ./Dockerfile
    dockerContext: ./ 
    plan: free
    region: singapore
    envVars:
      - key: JWT_SECRET_KEY
        value: secretkey_jwt123
      - key: JWT_ALGORITHM
        value: HS256
      - key: DATABASE_URL
        value: postgresql+asyncpg://postgres.yccuyuaqigkxosbpdcul:GyNiA90mn1TBObig@aws-1-ap-southeast-2.pooler.supabase.com:6543/postgres  # Từ compose.yml
      - key: ACCESS_TOKEN_EXPIRE_MINUTES
        value: 30
      - key: REFRESH_TOKEN_EXPIRE_DAYS
        value: 7
      - key: APP_ENV
        value: production  # Đổi từ development
      - key: USER_SERVICE_INTERNAL_BASE_URL
        value: https://petcare-user-management.onrender.com  # Internal call

  # User Management Service
  - type: web
    name: petcare-user-management
    env: docker
    repo: https://github.com/ngkhuy/Pet-Hub-B2C
    rootDir: ./user-management-service
    dockerfilePath: ./Dockerfile
    dockerContext: ./ 
    plan: free
    region: singapore
    envVars:
      - key: JWT_SECRET_KEY
        value: secretkey_jwt123
      - key: JWT_ALGORITHM
        value: HS256
      - key: DATABASE_URL
        value: postgresql+asyncpg://postgres.anwgeinbyeadpgnhszpr:WFQrRR17F5P49yoa@aws-1-ap-southeast-2.pooler.supabase.com:6543/postgres
      - key: MAIL_USERNAME
        value: ngkhuy.159@gmail.com
      - key: MAIL_PASSWORD
        value: ykly uuhs urir etzl
      - key: MAIL_FROM
        value: ngkhuy.159@gmail.com
      - key: MAIL_PORT
        value: 587
      - key: MAIL_SERVER
        value: smtp.gmail.com
      - key: MAIL_STARTTLS
        value: True
      - key: MAIL_SSL_TLS
        value: False
      - key: AUTH_SERVICE_INTERNAL_BASE_URL
        value: https://petcare-auth.onrender.com

  # Booking Service
  - type: web
    name: petcare-booking
    env: docker
    repo: https://github.com/ngkhuy/Pet-Hub-B2C
    rootDir: ./booking-service
    dockerfilePath: ./Dockerfile
    dockerContext: ./ 
    plan: free
    region: singapore
    envVars:
      - key: JWT_SECRET_KEY
        value: secretkey_jwt123
      - key: JWT_ALGORITHM
        value: HS256
      - key: DATABASE_URL
        value: postgresql+asyncpg://postgres.jxiugzjubbucxudvvbvo:SHVCxbOXIsmzLyLS@aws-1-ap-southeast-1.pooler.supabase.com:6543/postgres

  # Vet Service
  - type: web
    name: petcare-vet
    env: docker
    repo: https://github.com/ngkhuy/Pet-Hub-B2C
    rootDir: ./vet-service
    dockerfilePath: ./Dockerfile
    dockerContext: ./ 
    plan: free
    region: singapore
    envVars:
      - key: JWT_SECRET_KEY
        value: secretkey_jwt123
      - key: JWT_ALGORITHM
        value: HS256
      - key: DATABASE_URL
        value: postgresql+asyncpg://postgres.gwyspssvgudotjvdojpl:w18imz72gitJSK6W@aws-1-ap-south-1.pooler.supabase.com:6543/postgres